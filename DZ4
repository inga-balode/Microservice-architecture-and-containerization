Last login: Fri Mar 18 22:59:45 on ttys000

The default interactive shell is now zsh.
To update your account to use zsh, please run `chsh -s /bin/zsh`.
For more details, please visit https://support.apple.com/kb/HT208050.
Ingas-MacBook-Pro:~ inga$ ssh 34.159.114.27
Enter passphrase for key '/Users/inga/.ssh/id_rsa': 
Welcome to Ubuntu 18.04.6 LTS (GNU/Linux 5.4.0-1067-gcp x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Tue Mar 22 15:03:10 UTC 2022

  System load:  0.28              Processes:              202
  Usage of /:   63.0% of 9.52GB   Users logged in:        0
  Memory usage: 16%               IP address for ens4:    10.156.0.2
  Swap usage:   0%                IP address for docker0: 172.17.0.1

 * Super-optimized for small spaces - read how we shrank the memory
   footprint of MicroK8s to make it the smallest full K8s around.

   https://ubuntu.com/blog/microk8s-memory-optimisation

13 updates can be applied immediately.
1 of these updates is a standard security update.
To see these additional updates run: apt list --upgradable

New release '20.04.4 LTS' available.
Run 'do-release-upgrade' to upgrade to it.


*** System restart required ***
Last login: Tue Mar 22 13:58:14 2022 from 83.241.30.22
inga@instance-2:~$ curl -Lo minikube https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 69.2M  100 69.2M    0     0  64.5M      0  0:00:01  0:00:01 --:--:-- 64.5M
inga@instance-2:~$ chmod +x minikube
inga@instance-2:~$ sudo mv minikube /usr/local/bin
inga@instance-2:~$ sudo -i
root@instance-2:~# minikube start --vm-driver=none --docker-env NO_PROXY=$NO_PROXY
üòÑ  minikube v1.25.2 on Ubuntu 18.04 (vbox/amd64)
‚ú®  Using the none driver based on existing profile
üëç  Starting control plane node minikube in cluster minikube
üèÉ  Updating the running none "minikube" bare metal machine ...
‚ÑπÔ∏è  OS release is Ubuntu 18.04.6 LTS
üê≥  Preparing Kubernetes v1.23.3 on Docker 20.10.7 ...
    ‚ñ™ env NO_PROXY=
    ‚ñ™ kubelet.resolv-conf=/run/systemd/resolve/resolv.conf
    ‚ñ™ kubelet.housekeeping-interval=5m
ü§π  Configuring local host environment ...

‚ùó  The 'none' driver is designed for experts who need to integrate with an existing VM
üí°  Most users should use the newer 'docker' driver instead, which does not require root!
üìò  For more information, see: https://minikube.sigs.k8s.io/docs/reference/drivers/none/

‚ùó  kubectl and minikube configuration will be stored in /root
‚ùó  To use kubectl or minikube commands as your own user, you may need to relocate them. For example, to overwrite your own settings, run:

    ‚ñ™ sudo mv /root/.kube /root/.minikube $HOME
    ‚ñ™ sudo chown -R $USER $HOME/.kube $HOME/.minikube

üí°  This can also be done automatically by setting the env var CHANGE_MINIKUBE_NONE_USER=true
üîé  Verifying Kubernetes components...
    ‚ñ™ Using image gcr.io/k8s-minikube/storage-provisioner:v5
üåü  Enabled addons: default-storageclass, storage-provisioner
üèÑ  Done! kubectl is now configured to use "minikube" cluster and "default" namespace by default
root@instance-2:~# vi postgres-configmap.yaml
root@instance-2:~# kubectl apply -f postgres-configmap.yaml
configmap/postgres-config created
root@instance-2:~# vi postgers-pv.yaml
root@instance-2:~# kubectl apply -f postgers-pv.yaml
persistentvolume/postgres-pv-volume created
persistentvolumeclaim/postgres-pv-claim created
root@instance-2:~# vi postgres-deployment.yaml
root@instance-2:~# kubectl apply -f postgres-deployment.yaml
root@instance-2:~# vi postgres-deployment.yaml
root@instance-2:~# kubectl apply -f postgres-deployment.yaml
deployment.apps/postgres created
root@instance-2:~# kubectl get deployments
NAME            READY   UP-TO-DATE   AVAILABLE   AGE
deploymentpvc   2/2     2            2           17h
my-deployment   2/2     2            2           19h
postgres        1/1     1            1           51s
root@instance-2:~# kubectl get pod -o wide
NAME                             READY   STATUS    RESTARTS      AGE   IP            NODE         NOMINATED NODE   READINESS GATES
deploymentpvc-5d9d7746cc-hz4gf   1/1     Running   3 (25m ago)   17h   172.17.0.8    instance-2   <none>           <none>
deploymentpvc-5d9d7746cc-rhjlf   1/1     Running   3 (25m ago)   17h   172.17.0.7    instance-2   <none>           <none>
my-deployment-c4c8f45fc-jmz5h    1/1     Running   6 (25m ago)   19h   172.17.0.2    instance-2   <none>           <none>
my-deployment-c4c8f45fc-tvzdv    1/1     Running   6 (25m ago)   19h   172.17.0.9    instance-2   <none>           <none>
my-replicaset-6fswb              1/1     Running   5 (25m ago)   19h   172.17.0.3    instance-2   <none>           <none>
my-replicaset-mdpmv              1/1     Running   6 (25m ago)   19h   172.17.0.4    instance-2   <none>           <none>
my-replicaset-s5jxh              1/1     Running   5 (25m ago)   19h   172.17.0.5    instance-2   <none>           <none>
postgres-7d9c85cdcd-fqkfz        1/1     Running   0             69s   172.17.0.10   instance-2   <none>           <none>
root@instance-2:~# kubectl run -t -i --rm --image postgres:10.13 test bash
If you don't see a command prompt, try pressing enter.
root@test:/# psql -h 172.17.0.10 -U postgresadmin postgresdb
Password for user postgresadmin: 
psql (10.13 (Debian 10.13-1.pgdg90+1))
Type "help" for help.

postgresdb=# CREATE TABLE testtable (testcolumn VARCHAR (50) );
CREATE TABLE
postgresdb=# \dt
             List of relations
 Schema |   Name    | Type  |     Owner     
--------+-----------+-------+---------------
 public | testtable | table | postgresadmin
(1 row)

postgresdb-# \q
root@test:/# exit
exit
Session ended, resume using 'kubectl attach test -c test -i -t' command when the pod is running
pod "test" deleted
root@instance-2:~# kubectl delete pod postgres-7d9c85cdcd-fqkfz 
pod "postgres-7d9c85cdcd-fqkfz" deleted
root@instance-2:~# kubectl get pods
NAME                             READY   STATUS    RESTARTS      AGE
deploymentpvc-5d9d7746cc-hz4gf   1/1     Running   3 (37m ago)   17h
deploymentpvc-5d9d7746cc-rhjlf   1/1     Running   3 (37m ago)   18h
my-deployment-c4c8f45fc-jmz5h    1/1     Running   6 (37m ago)   19h
my-deployment-c4c8f45fc-tvzdv    1/1     Running   6 (37m ago)   19h
my-replicaset-6fswb              1/1     Running   5 (37m ago)   20h
my-replicaset-mdpmv              1/1     Running   6 (37m ago)   20h
my-replicaset-s5jxh              1/1     Running   5 (37m ago)   20h
postgres-7d9c85cdcd-vvqwf        1/1     Running   0             11s
root@instance-2:~# kubectl get pod -o wide
NAME                             READY   STATUS    RESTARTS      AGE   IP            NODE         NOMINATED NODE   READINESS GATES
deploymentpvc-5d9d7746cc-hz4gf   1/1     Running   3 (37m ago)   17h   172.17.0.8    instance-2   <none>           <none>
deploymentpvc-5d9d7746cc-rhjlf   1/1     Running   3 (37m ago)   18h   172.17.0.7    instance-2   <none>           <none>
my-deployment-c4c8f45fc-jmz5h    1/1     Running   6 (37m ago)   19h   172.17.0.2    instance-2   <none>           <none>
my-deployment-c4c8f45fc-tvzdv    1/1     Running   6 (37m ago)   19h   172.17.0.9    instance-2   <none>           <none>
my-replicaset-6fswb              1/1     Running   5 (37m ago)   20h   172.17.0.3    instance-2   <none>           <none>
my-replicaset-mdpmv              1/1     Running   6 (37m ago)   20h   172.17.0.4    instance-2   <none>           <none>
my-replicaset-s5jxh              1/1     Running   5 (37m ago)   20h   172.17.0.5    instance-2   <none>           <none>
postgres-7d9c85cdcd-vvqwf        1/1     Running   0             47s   172.17.0.10   instance-2   <none>           <none>
root@instance-2:~# kubectl run -t -i --rm --image postgres:10.13 test bash
If you don't see a command prompt, try pressing enter.
root@test:/# psql -h 172.17.0.10 -U postgresadmin postgresdb
Password for user postgresadmin: 
psql (10.13 (Debian 10.13-1.pgdg90+1))
Type "help" for help.

postgresdb=# \dt
             List of relations
 Schema |   Name    | Type  |     Owner     
--------+-----------+-------+---------------
 public | testtable | table | postgresadmin
(1 row)

postgresdb=# \q
root@test:/# exit
exit
Session ended, resume using 'kubectl attach test -c test -i -t' command when the pod is running
pod "test" deleted
root@instance-2:~# 
